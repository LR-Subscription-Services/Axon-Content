{
  "title": "Log4j Exploit Attempt",
  "version": 3,
  "description": "Attempts to exploit Log4j by passing malicious command.",
  "observationPipeline": {
    "pattern": {
      "operations": [
        {
          "touched": true,
          "blockType": "LOG_OBSERVED",
          "logObserved": {
            "filter": "general_information.log_source.type_name NOT CONTAINS \"zscaler\" AND general_information.raw_message CONTAINS \"jndi:\" AND general_information.raw_message NOT CONTAINS \"nessus\" AND general_information.log_source.type_name != \"Axon Case API\"",
            "groupByFields": [
              "observer.host.name"
            ]
          },
          "operationType": "WHERE_PATTERN_OPERATION",
          "isOutOfBoxRule": false,
          "ruleElementKey": "b8b9ab99-cdef-4012-b456-718d196c00e6"
        }
      ],
      "afterMatchSkipStrategy": "SKIP_PAST_LAST_EVENT"
    },
    "commonEvents": [
      "348a37e6-590e-4767-baae-a5c3951391ae",
      "28de4ee0-ca58-40f5-9ac7-ca38edf7883a"
    ],
    "metadataFields": {
      "threat.severity": "medium"
    }
  }
}